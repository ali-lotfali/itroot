<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§ - Ø®Ø¯Ù…Ø§Øª Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
    <meta name="description" content="Ø¯Ø±Ø¨Ø§Ø±Ù‡ ØªÛŒÙ… Ø®Ø¯Ù…Ø§Øª Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±ÛŒ - Û±Û°+ Ø³Ø§Ù„ ØªØ¬Ø±Ø¨Ù‡ Ø¯Ø± Ø§Ø±Ø§Ø¦Ù‡ Ø®Ø¯Ù…Ø§Øª ØªØ®ØµØµÛŒ IT Ø¨Ù‡ Ø´Ø±Ú©Øªâ€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú© Ùˆ Ù…ØªÙˆØ³Ø·">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Ù†ÙˆØ§Ø± Ø¨Ø§Ù„Ø§ÛŒÛŒ -->
<div id="header-placeholder"></div>

    </header>

    <!-- Ø¨Ø®Ø´ Ø§ØµÙ„ÛŒ -->
    <main>
        <!-- Ù‡ÛŒØ±Ùˆ -->
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h1>Ø¯Ø±Ø¨Ø§Ø±Ù‡ ØªÛŒÙ… Ø®Ø¯Ù…Ø§Øª Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±ÛŒ</h1>
                    <p>Û±Û°+ Ø³Ø§Ù„ ØªØ¬Ø±Ø¨Ù‡ Ø¯Ø± Ø§Ø±Ø§Ø¦Ù‡ Ø®Ø¯Ù…Ø§Øª ØªØ®ØµØµÛŒ IT Ø¨Ù‡ Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±Ù‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù†ÛŒ</p>
                </div>
            </div>
        </section>

                <!-- CTA -->
        <section class="cta">
            <div class="container">
                <h2>Ø¨Ù‡ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø±Ø§Ø¶ÛŒ Ù…Ø§ Ø¨Ù¾ÛŒÙˆÙ†Ø¯ÛŒØ¯</h2>
                <p>Ù‡Ù…ÛŒÙ† Ø­Ø§Ù„Ø§ Ø¨Ø§ Ù…Ø§ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯ Ùˆ Ø§Ø² Ø®Ø¯Ù…Ø§Øª Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ IT Ø¨Ù‡Ø±Ù‡â€ŒÙ…Ù†Ø¯ Ø´ÙˆÛŒØ¯</p>
                <a href="contact.html" class="btn btn-primary">Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…Ø´Ø§ÙˆØ±Ù‡ Ø±Ø§ÛŒÚ¯Ø§Ù†</a>
            </div>
        </section>


<body>
    <div class="container">
        <h1>ğŸ“ Ù…Ø¨Ø¯Ù„ ÙØ§ÛŒÙ„ - Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Word</h1>
        
        <div class="upload-container" id="dropZone">
            <div class="upload-icon">ğŸ“</div>
            <h3>ÙØ§ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø±Ù‡Ø§ Ú©Ù†ÛŒØ¯</h3>
            <p>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Word (DOCX), PDF, ØªØµØ§ÙˆÛŒØ± Ùˆ Ù…ØªÙ†</p>
            <input type="file" id="fileInput" accept=".docx,.pdf,.txt,.jpg,.jpeg,.png,.html" hidden>
        </div>

        <div class="file-info" id="fileInfo"></div>

        <div class="options-section">
            <h3 class="section-title">ğŸ“„ ÙØ±Ù…Øª Ø®Ø±ÙˆØ¬ÛŒ:</h3>
            <div class="format-grid" id="formatOptions">
                <!-- ÙØ±Ù…Øªâ€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </div>

        <div class="word-warning" id="wordWarning" style="display: none;">
            âš ï¸ ØªØ¨Ø¯ÛŒÙ„ Word Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¨Ø±Ø®ÛŒ ÙØ±Ù…Øªâ€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ø±Ø§ Ø­ÙØ¸ Ù†Ú©Ù†Ø¯
        </div>

        <div class="error" id="errorMessage"></div>

        <div class="progress-bar" id="progressBar">
            <div class="progress" id="progress"></div>
        </div>

        <div class="status" id="status"></div>

        <button class="convert-btn" id="convertBtn">
            ğŸ”„ Ø´Ø±ÙˆØ¹ ØªØ¨Ø¯ÛŒÙ„
        </button>

        <a class="download-btn" id="downloadBtn" download>
            â¬‡ï¸ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ ØªØ¨Ø¯ÛŒÙ„ Ø´Ø¯Ù‡
        </a>
    </div>

    <script>
        // ØªÙ†Ø¸ÛŒÙ… pdf.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        let selectedFile = null;
        const { jsPDF } = window.jspdf;

        // Ø¹Ù†Ø§ØµØ± DOM
        const elements = {
            dropZone: document.getElementById('dropZone'),
            fileInput: document.getElementById('fileInput'),
            fileInfo: document.getElementById('fileInfo'),
            formatOptions: document.getElementById('formatOptions'),
            convertBtn: document.getElementById('convertBtn'),
            progressBar: document.getElementById('progressBar'),
            progress: document.getElementById('progress'),
            status: document.getElementById('status'),
            downloadBtn: document.getElementById('downloadBtn'),
            errorMessage: document.getElementById('errorMessage'),
            wordWarning: document.getElementById('wordWarning')
        };

        // ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø´Ø¯Ù‡ Ø¨Ø§ Word
        const supportedConversions = {
            // Word Documents
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['pdf', 'txt', 'html'],
            
            // ØªØµØ§ÙˆÛŒØ±
            'image/jpeg': ['pdf', 'txt'],
            'image/png': ['pdf', 'txt'],
            
            // Ø§Ø³Ù†Ø§Ø¯
            'application/pdf': ['txt', 'html'],
            'text/plain': ['pdf', 'html'],
            'text/html': ['pdf', 'txt']
        };

        const formatNames = {
            'pdf': 'PDF',
            'txt': 'Ù…ØªÙ† (TXT)',
            'html': 'HTML'
        };

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„
        elements.dropZone.addEventListener('click', () => elements.fileInput.click());
        
        elements.fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });

        elements.dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.dropZone.style.background = '#f0f4ff';
        });

        elements.dropZone.addEventListener('dragleave', () => {
            elements.dropZone.style.background = '';
        });

        elements.dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.dropZone.style.background = '';
            if (e.dataTransfer.files.length > 0) {
                handleFileSelect(e.dataTransfer.files[0]);
            }
        });

        function handleFileSelect(file) {
            selectedFile = file;
            const fileSize = (file.size / 1024 / 1024).toFixed(2);
            
            elements.fileInfo.innerHTML = `
                <strong>âœ… ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯:</strong><br>
                ğŸ“ Ù†Ø§Ù…: ${file.name}<br>
                ğŸ’¾ Ø­Ø¬Ù…: ${fileSize} MB<br>
                ğŸ·ï¸ Ù†ÙˆØ¹: ${file.type || 'Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡'}
            `;
            elements.fileInfo.style.display = 'block';
            
            // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø´Ø¯Ø§Ø± Ø¨Ø±Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Word
            if (file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || 
                file.name.endsWith('.docx')) {
                elements.wordWarning.style.display = 'block';
            } else {
                elements.wordWarning.style.display = 'none';
            }
            
            loadAvailableFormats(file.type || getFileTypeFromName(file.name));
            elements.convertBtn.disabled = false;
            hideError();
        }

        function getFileTypeFromName(fileName) {
            const ext = fileName.toLowerCase().split('.').pop();
            const extensionMap = {
                'docx': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'pdf': 'application/pdf',
                'txt': 'text/plain',
                'html': 'text/html',
                'jpg': 'image/jpeg',
                'jpeg': 'image/jpeg',
                'png': 'image/png'
            };
            return extensionMap[ext] || 'unknown';
        }

        function loadAvailableFormats(fileType) {
            elements.formatOptions.innerHTML = '';
            
            const availableFormats = supportedConversions[fileType] || [];
            
            if (availableFormats.length === 0) {
                showError('Ø§ÛŒÙ† Ù†ÙˆØ¹ ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯');
                elements.convertBtn.disabled = true;
                return;
            }

            availableFormats.forEach(format => {
                const label = document.createElement('label');
                label.className = 'option-label';
                label.innerHTML = `
                    <input type="radio" name="format" value="${format}">
                    ${formatNames[format]}
                `;
                elements.formatOptions.appendChild(label);
            });

            if (availableFormats.length > 0) {
                elements.formatOptions.querySelector('input').checked = true;
            }
        }

        // ØªØ¨Ø¯ÛŒÙ„ ÙØ§ÛŒÙ„
        elements.convertBtn.addEventListener('click', convertFile);

        async function convertFile() {
            if (!selectedFile) {
                showError('Ù„Ø·ÙØ§ ÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                return;
            }

            const formatElement = document.querySelector('input[name="format"]:checked');
            if (!formatElement) {
                showError('Ù„Ø·ÙØ§ ÙØ±Ù…Øª Ø®Ø±ÙˆØ¬ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                return;
            }

            const targetFormat = formatElement.value;
            const fileType = selectedFile.type || getFileTypeFromName(selectedFile.name);

            try {
                elements.convertBtn.disabled = true;
                elements.progressBar.style.display = 'block';
                elements.status.style.display = 'block';
                hideError();

                await simulateProgress(30);

                let convertedBlob;

                // ØªØ¨Ø¯ÛŒÙ„ Word Ø¨Ù‡ ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
                if (fileType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {
                    if (targetFormat === 'pdf') {
                        convertedBlob = await convertDocxToPdf(selectedFile);
                    } else if (targetFormat === 'txt') {
                        convertedBlob = await convertDocxToText(selectedFile);
                    } else if (targetFormat === 'html') {
                        convertedBlob = await convertDocxToHtml(selectedFile);
                    }
                }
                // Ø³Ø§ÛŒØ± ØªØ¨Ø¯ÛŒÙ„â€ŒÙ‡Ø§
                else if (fileType.startsWith('image/')) {
                    if (targetFormat === 'pdf') {
                        convertedBlob = await convertImageToPdf(selectedFile);
                    } else if (targetFormat === 'txt') {
                        convertedBlob = await convertImageToText(selectedFile);
                    }
                } else if (fileType === 'application/pdf') {
                    if (targetFormat === 'txt') {
                        convertedBlob = await convertPdfToText(selectedFile);
                    } else if (targetFormat === 'html') {
                        convertedBlob = await convertPdfToHtml(selectedFile);
                    }
                } else if (fileType === 'text/plain') {
                    if (targetFormat === 'pdf') {
                        convertedBlob = await convertTextToPdf(selectedFile);
                    } else if (targetFormat === 'html') {
                        convertedBlob = await convertTextToHtml(selectedFile);
                    }
                } else if (fileType === 'text/html') {
                    if (targetFormat === 'pdf') {
                        convertedBlob = await convertHtmlToPdf(selectedFile);
                    } else if (targetFormat === 'txt') {
                        convertedBlob = await convertHtmlToText(selectedFile);
                    }
                } else {
                    throw new Error('Ø§ÛŒÙ† Ù†ÙˆØ¹ ØªØ¨Ø¯ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯');
                }

                await simulateProgress(100);

                // Ø§ÛŒØ¬Ø§Ø¯ Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯
                const outputName = generateOutputName(selectedFile.name, targetFormat);
                elements.downloadBtn.href = URL.createObjectURL(convertedBlob);
                elements.downloadBtn.download = outputName;
                elements.downloadBtn.style.display = 'block';
                
                elements.status.textContent = 'âœ… ØªØ¨Ø¯ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!';

            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„:', error);
                showError('Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ ÙØ§ÛŒÙ„: ' + error.message);
                elements.convertBtn.disabled = false;
            }
        }

        // ØªØ¨Ø¯ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Word
        async function convertDocxToText(docxFile) {
            elements.status.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ¨Ø¯ÛŒÙ„ Word Ø¨Ù‡ Ù…ØªÙ†...';
            
            try {
                // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Mammoth.js Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ØªÙ† Ø§Ø² DOCX
                const arrayBuffer = await readFileAsArrayBuffer(docxFile);
                const result = await mammoth.extractRawText({ arrayBuffer: arrayBuffer });
                
                if (result.value) {
                    return new Blob([result.value], { type: 'text/plain; charset=utf-8' });
                } else {
                    throw new Error('Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ù…ØªÙ† Ø±Ø§ Ø§Ø² ÙØ§ÛŒÙ„ Word Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ú©Ø±Ø¯');
                }
            } catch (error) {
                throw new Error('Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ Word: ' + error.message);
            }
        }

        async function convertDocxToHtml(docxFile) {
            elements.status.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ¨Ø¯ÛŒÙ„ Word Ø¨Ù‡ HTML...';
            
            try {
                const arrayBuffer = await readFileAsArrayBuffer(docxFile);
                const result = await mammoth.convertToHtml({ arrayBuffer: arrayBuffer });
                
                const htmlContent = `<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Ø³Ù†Ø¯ ØªØ¨Ø¯ÛŒÙ„ Ø´Ø¯Ù‡ Ø§Ø² Word</title>
    <style>
        body { 
            font-family: Tahoma, Arial, sans-serif; 
            line-height: 1.6; 
            padding: 40px;
            background: #f5f5f5;
        }
        .content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="content">
        ${result.value}
    </div>
</body>








    </main>

    <!-- ÙÙˆØªØ± -->
    <div id="footer-placeholder"></div>


    <script src="js/include.js"></script>
    <script src="js/script.js"></script>
</body>
</html>

